# Домашнее задание к занятию "3.6. Компьютерные сети, лекция 1"

1. Необязательное задание:
можно посмотреть целый фильм в консоли `telnet towel.blinkenlights.nl` :)

1. Узнайте о том, сколько действительно независимых (не пересекающихся) каналов есть в разделяемой среде WiFi при работе на 2.4 ГГц. Стандарты с полосой 5 ГГц более актуальны, но регламенты на 5 ГГц существенно различаются в разных странах, а так же не раз обновлялись. В качестве дополнительного вопроса вне зачета, попробуйте найти актуальный ответ и на этот вопрос.
   - **На 2.4 ГГц есть 3 независимых каналов: 1, 6, 11**
   - **На 5 ГГц:**
      - **Полоса UNII-1: 36, 40, 44 и 48**
      - **Полоса UNII-2: 52, 56, 60 и 64 (UNII-2A), от 100 до 140 (UNII-2C)**
      - **Полоса UNII-2 Extended: 100, 104, 108, 112, 116, 120, 124, 128, 132, 136, 140, 144**
      - **Полоса UNII-3: 149, 153, 157, 161**
      - **Полоса ISM: 165**
1. Адрес канального уровня – MAC адрес – это 6 байт, первые 3 из которых называются OUI – Organizationally Unique Identifier или уникальный идентификатор организации. Какому производителю принадлежит MAC `38:f9:d3:55:55:79`?
   - **Apple, Inc.**
1. Каким будет payload TCP сегмента, если Ethernet MTU задан в 9001 байт, размер заголовков IPv4 – 20 байт, а TCP – 32 байта?
   - **MTU (Maximum Transmission Unit) – размер полезных данных в одном фрейме (размер фрейма минус заголовки Ethernet, минус трейлер Ethernet)**
   - **Сегмент это данные транспортного уровня, на котором используется протокол TCP. Эти данные состоят из заголовка TCP и payload**
   - **payload = MTU - IP(header) - TCP(header), payload = 9001 - 20 - 32 = 8949**
1. Может ли во флагах TCP одновременно быть установлены флаги SYN и FIN при штатном режиме работы сети? Почему да или нет?
   - **При штатной работе сети флаги SYN и FIN не должны быть установленны одновременно. При попытке отправить их одновременно в ответ вернется RST, который означает что нужно разорвать соединение, т.к. пакет неправильный.** 
1. `ss -ula sport = :53` на хосте имеет следующий вывод:

```bash
State           Recv-Q          Send-Q                   Local Address:Port                     Peer Address:Port          Process
UNCONN          0               0                        127.0.0.53%lo:domain                        0.0.0.0:*
```

Почему в `State` присутствует только `UNCONN`, и может ли там присутствовать, например, `TIME-WAIT`?
   - **В `State` присутствует только `UNCONN`, т.к. этот сокет работает по протоколу `UDP`. По этой же причине невозможно состояние `TIME-WAIT`, т.к. оно наступает только после разырва соединения, которого при протоколе `UDP` нет.**
7. Обладая знаниями о том, как штатным образом завершается соединение (FIN от инициатора, FIN-ACK от ответчика, ACK от инициатора), опишите в каких состояниях будет находиться TCP соединение в каждый момент времени на клиенте и на сервере при завершении. Схема переходов состояния соединения вам в этом поможет.
   - **Изначальное состояние у ответчика и инициатора до закрытия содениения `ESTABLISHED`**
   - **Инициатор посылает `FIN` и переходит в состояние `FIN WAIT 1`**
   - **Ответчик получает `FIN`, переходит в состояние `CLOSE WAIT`  и отправляет в ответ `ACK`**
   - **Инициатор получает `ACK`, переходит в состояние `FIN WAIT 2`**
   - **Ответчик переходит в состояние `LAST ACK`  и отправляет `FIN`**
   - **Инициатор получает `FIN`, переходит в состояние `TIME WAIT` и отправляет в ответ `ACK`**
   - **После чего состояние у обоих соединений будет `CLOSED`** 
1. TCP порт – 16 битное число. Предположим, 2 находящихся в одной сети хоста устанавливают между собой соединения. Каким будет теоретическое максимальное число соединений, ограниченное только лишь параметрами L4, которое параллельно может установить клиент с одного IP адреса к серверу с одним IP адресом? Сколько соединений сможет обслужить сервер от одного клиента? А если клиентов больше одного?
   - **Теоретическое максимальное число соединений равно `65 536`**
   - **От одного клинета сервер сможет обслужить `65 536` соединений**
   - **Если клиентов будет больше одного, то сервер в сумме не сможет обслужить больше чем `65 536` соединений**
1. Может ли сложиться ситуация, при которой большое число соединений TCP на хосте находятся в состоянии  `TIME-WAIT`? Если да, то является ли она хорошей или плохой? Подкрепите свой ответ пояснением той или иной оценки.
   - **Да, такое может произойти, когда обе стороны одновременно инициировали закрытие и хост не может получить вовремя нужный ответ**
   - **Основаная проблема большого числа состояний `TIME-WAIT` заключается в исчерпании свободных портов и ресурсов системы** 
1. Чем особенно плоха фрагментация UDP относительно фрагментации TCP?
   - **Фрагментация UDP плоха относительно фрагментации TCP, тем что происходит на уровне ниже (L3 - Network) и не обрабатывается на стороне получателя целиком и могут быть отоброшены полностью.**
1. Если бы вы строили систему удаленного сбора логов, то есть систему, в которой несколько хостов отправяют на центральный узел генерируемые приложениями логи (предположим, что логи – текстовая информация), какой протокол транспортного уровня вы выбрали бы и почему? Проверьте ваше предположение самостоятельно, узнав о стандартном протоколе syslog.
   - **Для передачи текстовой ифнормации я бы выбрал проток TCP транспортного уровня, т.к. он бы позволил получить точную информацию и без ошибок в процессе передачи.** 
1. Сколько портов TCP находится в состоянии прослушивания на вашей виртуальной машине с Ubuntu, и каким процессам они принадлежат?
   - **Для того чтобы это узнать выполнил команду: `sudo ss -ltp`**
   - **В состоянии прослушивания находится 9  TCP портов**
   - **Процессы слущающие порты: `rpcbind, systemd-resolve, sshd, netdata, netdata, node_exporter, rpcbind, sshd, netdata`** 
1. Какой ключ нужно добавить в `tcpdump`, чтобы он начал выводить не только заголовки, но и содержимое фреймов в текстовом виде? А в текстовом и шестнадцатиричном?
   - **Для вывода содержимого фреймов в текстовом виде нужно добавить опцию `-A`**
   - **Для вывода содержимого фреймов в текстовом и шестнадцатиричном виде нужно добавить опцию `-X`** 
1. Попробуйте собрать дамп трафика с помощью `tcpdump` на основном интерфейсе вашей виртуальной машины и посмотреть его через tshark или Wireshark (можно ограничить число пакетов `-c 100`). Встретились ли вам какие-то установленные флаги Internet Protocol (не флаги TCP, а флаги IP)? Узнайте, какие флаги бывают. Как на самом деле называется стандарт Ethernet, фреймы которого попали в ваш дамп? Можно ли где-то в дампе увидеть OUI?
   - **Встречается флаг IP `Don't fragment`**
   - **Помимо вышенаписанного флага есть еще два флага IP: `Reserved bit` и `More fragments`**
   - **На самом деле используемый стандарт Ethernet называется в моем дампе: `Ethernet II`**
   - **OUI можно увидеть в информации об Ethernet, в первых шести символов макадресов отправителя и получателя**
